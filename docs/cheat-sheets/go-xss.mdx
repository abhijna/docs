---
title: "Prevent XSS for Go"
---

* [go](/docs/tags/go)
* [xss](/docs/tags/xss)


This is a cross-site scripting (XSS) prevention cheat sheet by Semgrep, Inc. It contains code patterns of potential XSS in an application. Instead of scrutinizing code for exploitable vulnerabilities, the recommendations in this cheat sheet pave a safe road for developers that mitigate the possibility of XSS in your code. By following these recommendations, you can be reasonably sure your code is free of XSS.

Learn more about [Cross-site Scripting](/docs/learn/vulnerabilities/cross-site-scripting) vulnerability concepts.

## Mitigation summary[​](#mitigation-summary "Direct link to Mitigation summary")

The Go template engine in `html/template` does automatic and contextual autoescaping, which mitigates many common XSS mistakes. Some aspects of the engine are confusingly named; therefore, proper use of the library should be enforced using code scanners. You may also consider using a stricter alternative, such as `safehtml`.

### Check your project using Semgrep[​](#check-your-project-using-semgrep "Direct link to Check your project using Semgrep")

The following command runs an optimized set of rules for your project:

```
semgrep --config p/default
```

## 1. Server code: Unescaped content[​](#1-server-code-unescaped-content "Direct link to 1. Server code: Unescaped content")

### 1.A. Using the `text/template` package[​](#1a-using-the-texttemplate-package "Direct link to 1a-using-the-texttemplate-package")

`text/template` does not perform any HTML escaping.

Example:

```
import "text/template"
```

#### References[​](#references "Direct link to References")

* [Common Go security mistakes](https://www.veracode.com/blog/secure-development/use-golang-these-mistakes-could-compromise-your-apps-security)

#### Mitigation[​](#mitigation "Direct link to Mitigation")

Ban `text/template`. Alternatively, use `html/template`, or a stricter alternative such as `safehtml`.

#### Semgrep rule[​](#semgrep-rule "Direct link to Semgrep rule")

[go.lang.security.audit.xss.import-text-template.import-text-template](https://semgrep.dev/r?q=go.lang.security.audit.xss.import-text-template.import-text-template)

### 1.B. Escaped types: `template.HTML`[​](#1b-escaped-types-templatehtml "Direct link to 1b-escaped-types-templatehtml")

`template.HTML` is a special type which instructs the template engine not to escape the content.

Example:

```
content := template.HTML("<div>" + user.name + "</div>")
```

#### References[​](#references-1 "Direct link to References")

* [`template.HTML` documentation](https://golang.org/pkg/html/template/#HTML)

#### Mitigation[​](#mitigation-1 "Direct link to Mitigation")

Ban `template.HTML`. Alternatively, if necessary, review each case carefully and exempt with `# nosemgrep`.

#### Semgrep rule[​](#semgrep-rule-1 "Direct link to Semgrep rule")

[go.lang.security.audit.xss.template-html-does-not-escape.unsafe-template-type](https://semgrep.dev/r?q=go.lang.security.audit.xss.template-html-does-not-escape.unsafe-template-type)

### 1.C. Escaped types: `template.HTMLAttr`[​](#1c-escaped-types-templatehtmlattr "Direct link to 1c-escaped-types-templatehtmlattr")

`template.HTMLAttr` is a special type which instructs the template engine not to escape the content.

Example:

```
content := template.HTMLAttr("class=" + user.role)
```

#### References[​](#references-2 "Direct link to References")

* [`template.HTMLAttr` documentation](https://golang.org/pkg/html/template/#HTMLAttr)

#### Mitigation[​](#mitigation-2 "Direct link to Mitigation")

Ban `template.HTMLAttr`. Alternatively, prefer `template.HTML`, only if necessary.

#### Semgrep rule[​](#semgrep-rule-2 "Direct link to Semgrep rule")

[go.template.security.insecure-types.go-insecure-templates](https://semgrep.dev/r?q=go.template.security.insecure-types.go-insecure-templates)

### 1.D. Escaped types: `template.CSS`[​](#1d-escaped-types-templatecss "Direct link to 1d-escaped-types-templatecss")

`template.CSS` is a special type which instructs the template engine not to escape the content in CSS contexts.

Example:

```
content := template.CSS("body { color: black; }")
```

#### References[​](#references-3 "Direct link to References")

* [`template.CSS` documentation](https://golang.org/pkg/html/template/#CSS)

#### Mitigation[​](#mitigation-3 "Direct link to Mitigation")

Ban `template.CSS`. Alternatively, if necessary, review each case carefully and exempt with `# nosemgrep`.

#### Semgrep rule[​](#semgrep-rule-3 "Direct link to Semgrep rule")

[go.template.security.insecure-types.go-insecure-templates](https://semgrep.dev/r?q=go.template.security.insecure-types.go-insecure-templates)

### 1.E. Escaped types: template.JS[​](#1e-escaped-types-templatejs "Direct link to 1.E. Escaped types: template.JS")

The `template.JS` is a special type which instructs the template engine not to escape the content in JavaScript contexts, such as between `script` tags.

Example:

```
content := template.JS("var name = " + user.name)
```

#### References[​](#references-4 "Direct link to References")

* [`template.JS` documentation](https://golang.org/pkg/html/template/#JS)
* [Example demonstrating unsafe usage](https://goplay.space/#th5GWEwMck2)
* [Example demonstrating safe usage](https://goplay.space/#SfeTNbNARUq)

#### Mitigation[​](#mitigation-4 "Direct link to Mitigation")

Ban `template.JS`. Alternatively, place JavaScript code in files separate from HTML and serve them using the `src` attribute.

#### Semgrep rule[​](#semgrep-rule-4 "Direct link to Semgrep rule")

[go.template.security.insecure-types.go-insecure-templates](https://semgrep.dev/r?q=go.template.security.insecure-types.go-insecure-templates)

### 1.F. Escaped types: template.JSStr[​](#1f-escaped-types-templatejsstr "Direct link to 1.F. Escaped types: template.JSStr")

The `template.JSStr` is a special type which instructs the template engine not to escape the content when in JavaScript contexts and in a string.

Example:

```
content := template.JSStr("Error by: " + user.name)
```

#### References[​](#references-5 "Direct link to References")

* [`template.JSStr` documentation](https://golang.org/pkg/html/template/#JSStr)

#### Mitigation[​](#mitigation-5 "Direct link to Mitigation")

Ban `template.JSStr`. Alternatively, place JavaScript code in files separate from HTML and serve them using the `src` attribute.

#### Semgrep rule[​](#semgrep-rule-5 "Direct link to Semgrep rule")

[go.template.security.insecure-types.go-insecure-templates](https://semgrep.dev/r?q=go.template.security.insecure-types.go-insecure-templates)

### 1.G. Escaped types: `template.Srcset`[​](#1g-escaped-types-templatesrcset "Direct link to 1g-escaped-types-templatesrcset")

`template.Srcset` is a special type which instructs the template engine not to escape the content.

Example:

```
content := template.Srcset("https://" + user.stylepageurl)
```

#### References[​](#references-6 "Direct link to References")

* [`template.Srcset` documentation](https://golang.org/pkg/html/template/#Srcset)

#### Mitigation[​](#mitigation-6 "Direct link to Mitigation")

Ban `template.Srcset`. Alternatively, prefer `template.HTML`, only if necessary.

#### Semgrep rule[​](#semgrep-rule-6 "Direct link to Semgrep rule")

[go.template.security.insecure-types.go-insecure-templates](https://semgrep.dev/r?q=go.template.security.insecure-types.go-insecure-templates)

### 1.H. Escaped types: template.URL[​](#1h-escaped-types-templateurl "Direct link to 1.H. Escaped types: template.URL")

The `template.URL` is a special type which instructs the template engine not to escape the content.

Example:

```
content := template.URL("https://" + user.stylepageurl)
```

#### References[​](#references-7 "Direct link to References")

* [`template.URL` documentation](https://golang.org/pkg/html/template/#URL)

#### Mitigation[​](#mitigation-7 "Direct link to Mitigation")

Ban `template.URL`. Alternatively, if necessary, review each case carefully and exempt with `# nosem`.

#### Semgrep rule[​](#semgrep-rule-7 "Direct link to Semgrep rule")

[go.template.security.insecure-types.go-insecure-templates](https://semgrep.dev/r?q=go.template.security.insecure-types.go-insecure-templates)

***

## 2. Server code: Bypassing the template engine[​](#2-server-code-bypassing-the-template-engine "Direct link to 2. Server code: Bypassing the template engine")

### 2.A. Writing directly to the response object: fmt.Fprintf()[​](#2a-writing-directly-to-the-response-object-fmtfprintf "Direct link to 2.A. Writing directly to the response object: fmt.Fprintf()")

Writing directly to the response object bypasses the template engine which means content will not be autoescaped. This could introduce a XSS vulnerability.

Example:

```
fmt.Fprintf(w, "<div>" + user.name + "</div>")
```

#### References[​](#references-8 "Direct link to References")

* [Go Security - XSS](https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/)

#### Mitigation[​](#mitigation-8 "Direct link to Mitigation")

Ban using `fmt.Printf` with the HTTP response writer. Alternatively, use `html/template` to render data to users.

#### Semgrep rule[​](#semgrep-rule-8 "Direct link to Semgrep rule")

[go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter](https://semgrep.dev/r?q=go.lang.security.audit.xss.no-fprintf-to-responsewriter.no-fprintf-to-responsewriter)

### 2.C. Writing directly to the response object: `io.WriteString()`[​](#2c-writing-directly-to-the-response-object-iowritestring "Direct link to 2c-writing-directly-to-the-response-object-iowritestring")

Writing directly to the response object bypasses the template engine which means content will not be autoescaped. This could introduce a XSS vulnerability.

Example:

```
io.WriteString(w, "<div>" + user.name + "</div>")
```

#### References[​](#references-9 "Direct link to References")

* [Go Security - XSS](https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/)
* [`io.WriteString` documentation](https://golang.org/pkg/io/#WriteString)

#### Mitigation[​](#mitigation-9 "Direct link to Mitigation")

Ban using `io.WriteString` with the HTTP response writer. Alternatively, use `html/template` to render data to users.

#### Semgrep rule[​](#semgrep-rule-9 "Direct link to Semgrep rule")

[go.lang.security.audit.xss.no-io-writestring-to-responsewriter.no-io-writestring-to-responsewriter](https://semgrep.dev/r?q=go.lang.security.audit.xss.no-io-writestring-to-responsewriter.no-io-writestring-to-responsewriter)

### 2.C. Writing directly to the response object: w\.Write() method[​](#2c-writing-directly-to-the-response-object-wwrite-method "Direct link to 2.C. Writing directly to the response object: w.Write() method")

Writing directly to the response object bypasses the template engine which means content will not be autoescaped. This could introduce a XSS vulnerability.

Example:

```
writer.Write([]byte("<div>" + user.name + "</div>"))
```

#### References[​](#references-10 "Direct link to References")

* [Go Security - XSS](https://blogtitle.github.io/robn-go-security-pearls-cross-site-scripting-xss/)
* [Sample vulnerable app](https://gist.github.com/minusworld/62d30f299072bc6c0979778f4c00242f)

#### Mitigation[​](#mitigation-10 "Direct link to Mitigation")

Ban using the `Write` method of the HTTP response writer. Alternatively, use `html/template` to render data to users.

#### Semgrep rule[​](#semgrep-rule-10 "Direct link to Semgrep rule")

[go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter](https://semgrep.dev/r?q=go.lang.security.audit.xss.no-direct-write-to-responsewriter.no-direct-write-to-responsewriter)

***

Not finding what you need in this doc? Ask questions in our [Community Slack group](https://go.semgrep.dev/slack), or see [Support](/docs/support/) for other ways to get help.

**Tags:**

* [go](/docs/tags/go)
* [xss](/docs/tags/xss)

[Edit this page](https://github.com/semgrep/semgrep-docs/edit/main/docs/cheat-sheets/go-xss.mdx)

Last updated on **Sep 30, 2025**
