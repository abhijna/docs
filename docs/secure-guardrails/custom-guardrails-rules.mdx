---
title: "Custom rules for secure guardrails"
---

* [Secure guardrails](/docs/tags/secure-guardrails)

Copy as md

You can create custom Semgrep rules and deploy them as guardrails to enforce your organization's secure coding conventions.

## Prerequisites[​](#prerequisites "Direct link to Prerequisites")

* An understanding of [secure guardrails](/docs/secure-guardrails/secure-guardrails-in-semgrep).
* Knowledge of the basic Semgrep rule structure is helpful. See [Rule syntax](/docs/writing-rules/rule-syntax) and [Pattern syntax](/docs/writing-rules/pattern-syntax) documentation.
* Enabling [Code search (beta)](/docs/semgrep-code/editor#code-search-beta) is useful in verifying that your rule matches what you want it to match within your repositories.

## General steps[​](#general-steps "Direct link to General steps")

1. Create a custom Semgrep rule.
2. Verify and test that the rule matches the code you want to detect.
3. Optional: Set the custom Semgrep rule as a secure default.
4. Deploy the rule as a guardrail in the following developer interfaces: IDE, PR or MR comments, or `pre-commit`.

The following table lists the relevant documentation for each step:

| Steps                                      | References and notes                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
| ------------------------------------------ | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| Create a custom rule                       | In addition to the **[required fields](/docs/writing-rules/rule-syntax#required)** of a Semgrep rule, the following metadata fields are useful:- `category`
- `confidence`
- `likelihood`
- `impact`
- `subcategory`Filling out `confidence` and `impact` in particular is useful for filtering rules within the Semgrep web app. Read the [metadata reference documentation](/docs/contributing/contributing-to-semgrep-rules-repository#fields-required-by-the-security-category). |
| Verify that the rule matches as intended   | * See [Testing rules](/docs/writing-rules/testing-rules).
* Enable [Code search (beta)](/docs/semgrep-code/editor#code-search-beta) to test the rule on live repositories.                                                                                                                                                                                                                                                                                                           |
| Optional: Set the rule as a secure default | When creating a custom secure default, you must use `category: security` and `subcategory: secure default` values in your rule (see [Secure default snippet](#secure-default-snippet)).                                                                                                                                                                                                                                                                                              |
| Deploy the rule as a guardrail             | For PR or MR comments:* [Ensure that PR or MR comments have been set up correctly.](/docs/category/pr-or-mr-comments)
* Set the rule to [Comment or Block mode](/docs/semgrep-code/policies#block-a-pr-or-mr-through-rule-modes).For IDEs: Require developers to install the [Semgrep extension for their IDE](/docs/extensions/overview).For `pre-commit`: [Install and configure Semgrep for `pre-commit`](/docs/extensions/pre-commit).                                           |

### Secure default snippet[​](#secure-default-snippet "Direct link to Secure default snippet")

When creating a custom secure default, you must use `category: security` and `subcategory: secure default` values in your rule:

```
rules:  - id: some-custom-default    ...    metadata:      category: security      subcategory:        - secure default    ...
```

***

Not finding what you need in this doc? Ask questions in our [Community Slack group](https://go.semgrep.dev/slack), or see [Support](/docs/support/) for other ways to get help.

**Tags:**

* [Secure guardrails](/docs/tags/secure-guardrails)

[Edit this page](https://github.com/semgrep/semgrep-docs/edit/main/docs/secure-guardrails/custom-guardrails-rules.md)

Last updated on **Apr 1, 2025**
